<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Extrair Dados de Excel</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        label {
            font-weight: bold;
        }
        .data-container {
            margin-top: 20px;
        }
        .data-item {
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <h1>Extrair Dados de Planilha Excel</h1>
    <input type="file" id="fileInput" accept=".xlsx" />

    <div class="data-container" id="dataContainer">
        <!-- Os campos extraídos serão exibidos aqui -->
    </div>

    <script>
        // Mapear os labels para as células correspondentes
        const labels = [
            "Cliente", "Entrada", "Código de Barras", "Descrição", "M.S", "Umidade", "FDA", "FDNmo", "Lignina",
            "Amido", "P. Bruta", "PIDA", "PIDN", "P. Solúvel", "E.E", "Cinzas", "pH", "A. Láctico", "A. Acético",
            "A. Butírico", "dFDNp 48h", "uFDN 240h", "Dig. In situ do Amido 7h", "Kd do FDN", "Kd do Amido", "NDT", "Milk/Ton"
        ];

        const cells = [
            "A6", "F6", "H6", "I6", "CN6", "CO6", "CP6", "CR6", "CS6", "CT6",
            "DA6", "DD6", "DE6", "DI6", "DQ6", "EG6", "EM6", "EN6", "EO6",
            "EP6", "FB6", "FL6", "FV6", "FY6", "FZ6", "GE6", "GF6"
        ];

        document.getElementById('fileInput').addEventListener('change', handleFile, false);

        function handleFile(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function (e) {
                const data = new Uint8Array(e.target.result);
                const workbook = XLSX.read(data, { type: 'array' });

                // Supondo que os dados estão na primeira aba
                const sheetName = workbook.SheetNames[0];
                const worksheet = workbook.Sheets[sheetName];

                const dataContainer = document.getElementById('dataContainer');
                dataContainer.innerHTML = ''; // Limpar antes de exibir novos dados

                labels.forEach((label, index) => {
                    const cellValue = worksheet[cells[index]] ? worksheet[cells[index]].v : 'N/A';
                    
                    const dataItem = document.createElement('div');
                    dataItem.classList.add('data-item');

                    const labelElement = document.createElement('label');
                    labelElement.textContent = `${label}: `;

                    const valueElement = document.createElement('span');
                    valueElement.textContent = cellValue;

                    dataItem.appendChild(labelElement);
                    dataItem.appendChild(valueElement);
                    dataContainer.appendChild(dataItem);
                });
            };

            reader.readAsArrayBuffer(file);
        }
    </script>
</body>
</html>
