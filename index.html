<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Formulário de Análise de Amostra</title>
  <style>
    /* Mesma estilização fornecida */
  </style>
</head>
<body>
  <div class="container">
    <div style="text-align: center; margin-bottom: 20px;">
      <img src="https://th.bing.com/th/id/R.1d28d53e94518beab66fcea9aa29ba6d?rik=omvtwv5JhZw7Xw&riu=http%3a%2f%2ffrigorificoarvoredo.com.br%2fblog%2fwp-content%2fthemes%2f2op%2fimages%2farvoredo-facebook.jpg&ehk=eRCT9QZH2qJskR3EC4yypW2NHrWR1hbo6zflcj6F804%3d&risl=&pid=ImgRaw&r=0" 
           alt="Imagem" style="max-width: 100%; height: auto;">
    </div>
    <h1>Formulário de Análise de Amostra</h1>
    <form id="amostraForm">
      <!-- Campos do formulário conforme fornecido -->
      <button type="submit">Enviar</button>
    </form>
  </div>

  <script>
    // Função para salvar dados no localStorage
    function saveFormData() {
      const formData = {
        cliente: document.getElementById('cliente').value,
        entrada: document.getElementById('entrada').value,
        codigoBarras: document.getElementById('codigoBarras').value,
        descricao: document.getElementById('descricao').value,
        ms: document.getElementById('ms').value,
        umidade: document.getElementById('umidade').value,
        fda: document.getElementById('fda').value,
        fdnmo: document.getElementById('fdnmo').value,
        lignina: document.getElementById('lignina').value,
        amido: document.getElementById('amido').value,
        pBruta: document.getElementById('pBruta').value,
        pida: document.getElementById('pida').value,
        pidn: document.getElementById('pidn').value,
        pSoluvel: document.getElementById('pSoluvel').value,
        ee: document.getElementById('ee').value,
        cinzas: document.getElementById('cinzas').value,
        ph: document.getElementById('ph').value,
        aLactico: document.getElementById('aLactico').value,
        aAcetico: document.getElementById('aAcetico').value,
        aButirico: document.getElementById('aButirico').value,
        dFDNp48h: document.getElementById('dFDNp48h').value,
        uFDN240h: document.getElementById('uFDN240h').value,
        digInSituAmido: document.getElementById('digInSituAmido').value,
        kdFdn: document.getElementById('kdFdn').value,
        kdAmido: document.getElementById('kdAmido').value,
        ndt: document.getElementById('ndt').value,
        milkTon: document.getElementById('milkTon').value,
      };

      const storedData = JSON.parse(localStorage.getItem('formData')) || [];
      storedData.push(formData);
      localStorage.setItem('formData', JSON.stringify(storedData));
    }

    // Função para enviar dados para o Google Sheets
    async function sendToGoogleSheets(formData) {
      const scriptURL = 'https://script.google.com/macros/s/AKfycbyoXrmiK2QhQSQtfkQyTMuJA2x5fcuSMwEsmvh0db9hCCZhtzjDryF8XVvWXV_vhDjZaw/exec';

      try {
        const response = await fetch(scriptURL, {
          method: 'POST',
          body: new URLSearchParams(formData),
        });

        const data = await response.json();
        console.log('Resposta do servidor:', data);

        if (data.result === 'success') {
          alert(data.message || 'Dados enviados com sucesso!');
          console.log('Detalhes:', data);
        } else {
          alert(`Erro ao enviar dados: ${data.message || 'Verifique o servidor.'}`);
        }
      } catch (error) {
        console.error('Erro ao enviar os dados:', error);
        alert('Erro na conexão. Tente novamente mais tarde.');
      }
    }

    // Evento do formulário
    document.getElementById('amostraForm').addEventListener('submit', function (event) {
      event.preventDefault(); // Evitar recarregar página
      const formData = new FormData(this);

      // Salvar localmente
      saveFormData();

      // Enviar para o Google Sheets
      sendToGoogleSheets(Object.fromEntries(formData.entries()));

      // Resetar o formulário
      this.reset();
    });
  </script>
</body>
</html>
