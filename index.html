<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Importar Dados da Planilha</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
</head>
<body>
  <h1>Importar Dados da Planilha</h1>

  <input type="file" id="file-input" accept=".xlsx, .xls" />
  <button onclick="sendData()">Enviar Dados para o Google Sheets</button>

  <script>
    let extractedData = [];

    // Função para ler e extrair os dados da planilha
    function readExcel(file) {
      const reader = new FileReader();
      reader.onload = function (e) {
        const data = new Uint8Array(e.target.result);
        const workbook = XLSX.read(data, { type: 'array' });
        const sheet = workbook.Sheets[workbook.SheetNames[0]]; // A primeira planilha
        extractedData = [
          sheet["A6"].v, sheet["F6"].v, sheet["H6"].v, sheet["I6"].v, 
          sheet["CN6"].v, sheet["CO6"].v, sheet["CP6"].v, sheet["CR6"].v,
          sheet["CS6"].v, sheet["CT6"].v, sheet["DA6"].v, sheet["DD6"].v,
          sheet["DE6"].v, sheet["DI6"].v, sheet["DQ6"].v, sheet["EG6"].v,
          sheet["EM6"].v, sheet["EN6"].v, sheet["EO6"].v, sheet["EP6"].v,
          sheet["FB6"].v, sheet["FL6"].v, sheet["FV6"].v, sheet["FY6"].v,
          sheet["FZ6"].v, sheet["GE6"].v, sheet["GF6"].v
        ];
        console.log(extractedData); // Exibe os dados extraídos no console para checar
      };
      reader.readAsArrayBuffer(file);
    }

    // Função chamada quando o usuário seleciona um arquivo
    document.getElementById('file-input').addEventListener('change', function(e) {
      const file = e.target.files[0];
      if (file) {
        readExcel(file);
      }
    });

    // Função para enviar os dados extraídos para o Google Apps Script
    function sendData() {
      if (extractedData.length > 0) {
        google.script.run.sendDataToGoogleSheets(extractedData);
        alert('Dados enviados com sucesso!');
      } else {
        alert('Por favor, carregue uma planilha.');
      }
    }
  </script>
</body>
</html>
